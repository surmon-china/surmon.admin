import{bt as j,ah as i,j as a,F as y,a5 as v,T as L,K as f,b4 as T,bu as W,af as $,an as F,bv as H,bw as I,G as R,a8 as U,bx as z,x as D}from"./vendor-Dq6kaL7q.js";import{U as w,a as B,m as K,s as O,t as P,b as G,c as Y}from"./index-NovFo38d.js";import{g as ge}from"./index-NovFo38d.js";import{W as p,a as q,m as A,K as J,b as S}from"./monaco-editor-CZVC83gD.js";import"./basic-CjzmQg7q.js";self.MonacoEnvironment={getWorker(e,m){return m==="json"?new p:new q}};j.config({monaco:A});j.init().then(()=>{console.log("monaco-editor is available.")});const Q="_universalEditor_18ya2_5",V="_formStatus_18ya2_5",X="_fullScreen_18ya2_13",Z="_container_18ya2_25",ee="_toolbar_18ya2_28",ae="_logo_18ya2_39",ne="_language_18ya2_42",se="_editorWrapper_18ya2_51",te="_preview_18ya2_69",oe="_markdown_18ya2_79",s={universalEditor:Q,formStatus:V,fullScreen:X,container:Z,toolbar:ee,logo:ae,language:ne,editorWrapper:se,preview:te,markdown:oe},ce=e=>{var _;const m=e.placeholder??"请输入内容...",c=e.value??"",h=e.eid||window.location.pathname,l=i.useRef(),[o,x]=i.useState(!1),[r,E]=i.useState(!1),[d,C]=i.useState(e.defaultLanguage||w.Markdown),g=i.useMemo(()=>({tabSize:2,fontSize:14,lineHeight:24,smoothScrolling:!0,readOnly:!!e.disbaled,minimap:{enabled:!e.disabledMinimap},folding:!0,contextmenu:!1,roundedSelection:!1,scrollBeyondLastLine:!1,occurrencesHighlight:"multiFile",wordBasedSuggestions:"currentDocument",acceptSuggestionOnEnter:"on",scrollbar:{alwaysConsumeMouseWheel:!1}}),[e.disbaled,e.disabledMinimap]),M=i.useMemo(()=>{const n=e.rows||34,t=g.lineHeight||24;return{height:o?"100%":`${n*t}px`}},[e.rows,g.lineHeight,o]),k=n=>{l.current=n,l.current.onDidFocusEditorText(()=>{var t,u;(t=l.current)==null||t.addCommand(J.CtrlCmd|S.KeyS,b),(u=l.current)==null||u.addCommand(S.Escape,()=>x(!1))})},N=n=>{var t;e.disabledCacheDraft||O(h,n||""),(t=e.onChange)==null||t.call(e,n)},b=()=>{const n=P(Date.now()),t=G.get(d).ext,u=`${h}-${n}.${t}`;Y(c,u)};return i.useEffect(()=>{var n;o?((n=l.current)==null||n.focus(),document.body.classList.add("fullscreen")):document.body.classList.remove("fullscreen")},[o]),a.jsxs("div",{style:e.style,className:y(s.universalEditor,e.formStatus&&s.formStatus,o&&s.fullScreen),children:[!e.disabledToolbar&&a.jsxs("div",{className:s.toolbar,children:[a.jsxs(v,{className:s.left,wrap:!0,children:[a.jsx(L.Text,{type:"secondary",strong:!0,className:s.logo,children:"UEditor"}),a.jsx(f,{size:"small",disabled:e.disbaled,icon:a.jsx(T,{}),onClick:b})]}),a.jsxs(v,{className:s.right,wrap:!0,children:[(_=e.renderToolbarExtra)==null?void 0:_.call(e,d),d===w.Markdown&&a.jsx(f,{size:"small",disabled:e.disbaled,icon:r?a.jsx(W,{}):a.jsx($,{}),onClick:()=>E(!r)}),a.jsx(F,{size:"small",className:s.language,value:d,onChange:C,disabled:e.disbaled||r,options:B.map(n=>({label:n.name,value:n.id}))}),a.jsx(f,{size:"small",disabled:e.disbaled,icon:o?a.jsx(H,{}):a.jsx(I,{}),onClick:()=>x(!o)})]})]}),a.jsx(R,{spinning:!!e.loading,indicator:a.jsx(U,{style:{fontSize:24},spin:!0}),children:a.jsxs("div",{className:s.container,children:[a.jsx(z,{wrapperProps:{"data-placeholder":m,"data-nonempty":!!c,className:s.editorWrapper,style:{width:r?"50%":"100%",...M}},className:s.editor,theme:"vs-dark",language:d,value:c,options:g,onChange:N,onMount:k}),a.jsx(D,{in:r,timeout:200,unmountOnExit:!0,classNames:"fade-fast",children:a.jsx("div",{className:y(s.preview),children:a.jsx("div",{className:s.markdown,dangerouslySetInnerHTML:{__html:K(c)}})})})]})})]})};export{w as UEditorLanguage,G as UEditorLanguageMap,B as UEditorLanguages,ce as UniversalEditor,ge as getUEditorCache,O as setUEditorCache};
