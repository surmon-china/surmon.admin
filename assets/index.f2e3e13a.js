import{r as B,bv as F,d as V,J as $,ai as u,ap as j,j as a,y as h,a6 as z,m as J,N as _,b5 as K,bw as G,ag as q,aq as A,bx as P,by as X,z as Y,a9 as Q,l as Z}from"./vendor.1aea9854.js";import{U as m,s as p,m as ee,t as ne,a as ae}from"./index.08100166.js";import{U as He,g as ze,s as Re}from"./index.08100166.js";import{W as te,a as le,e as R,K as ie,b as I}from"./monaco-editor.1bd8d5b7.js";import"./basic.9ac7729a.js";const w=B({fullscreen:!1});F(()=>w.fullscreen,e=>{e?document.body.classList.add("fullscreen"):document.body.classList.remove("fullscreen")});const oe=e=>{w.fullscreen=e},se={state:V(w),setFullscreen:oe};self.MonacoEnvironment={getWorker(e,v){return v==="json"?new te:new le}};const re="_universalEditor_1eh0e_5",ue="_formStatus_1eh0e_5",de="_fullScreen_1eh0e_13",ce="_container_1eh0e_25",me="_toolbar_1eh0e_28",fe="_logo_1eh0e_37",Ne="_language_1eh0e_40",ve="_editor_1eh0e_50",be="_placeholder_1eh0e_54",ge="_preview_1eh0e_63",he="_markdown_1eh0e_72",s={universalEditor:re,formStatus:ue,fullScreen:de,container:ce,toolbar:me,logo:fe,language:Ne,editor:ve,placeholder:be,preview:ge,markdown:he};var t="/home/runner/work/veact-admin/veact-admin/src/components/common/UniversalEditor/index.tsx";const _e=new Map([[m.Markdown,"md"],[m.JSON,"json"]]),we=48,N=24,Ee=34,Se=40,ke=e=>{var C;const v=e.placeholder||"\u8BF7\u8F93\u5165\u5185\u5BB9...",b=e.value||"",E=e.eid||window.location.pathname,d=$(()=>se),g=u.exports.useRef(null),i=u.exports.useRef(),[f,T]=u.exports.useState(!1),[c,W]=u.exports.useState(e.defaultLanguage||m.Markdown),S=()=>{const n=ne(Date.now()),l=_e.get(c),o=`${E}-${n}.${l}`;ae(b,o)},y=()=>{var o,r;const n=f?.5:1,l=(o=i.current)==null?void 0:o.getLayoutInfo();(r=i.current)==null||r.layout({width:d.state.fullscreen?window.innerWidth*n:g.current.clientWidth*n,height:l.height})},x=u.exports.useCallback(()=>{var o,r,M;if(!i.current)return!1;const n=i.current.getLayoutInfo();let l=0;if(d.state.fullscreen)l=window.innerHeight-we;else{const k=((o=e.maxRows)!=null?o:Se)*N,L=((r=e.minRows)!=null?r:Ee)*N,O=i.current.getContentHeight(),U=(M=i.current.getModel())==null?void 0:M.getLineCount();if(O)if(O>k)l=k;else{const H=U*N;H<L?l=L:l=H}}n.height!==l&&i.current.layout({width:n.width,height:l})},[d.state.fullscreen,e.maxRows,e.minRows]),D=()=>{const n=R.create(g.current,{value:b,language:c,theme:"vs-dark",tabSize:2,fontSize:14,lineHeight:N,smoothScrolling:!0,readOnly:Boolean(e.disbaled),minimap:{enabled:!e.disabledMinimap},folding:!0,contextmenu:!1,roundedSelection:!1,scrollBeyondLastLine:!1,wordBasedSuggestions:!0,acceptSuggestionOnEnter:"on",scrollbar:{alwaysConsumeMouseWheel:!1}});return n.addCommand(ie.CtrlCmd|I.KeyS,S),n.addCommand(I.Escape,()=>d.setFullscreen(!1)),n};return j(()=>d.state.fullscreen,()=>x()),u.exports.useEffect(()=>{y()},[y,f]),u.exports.useEffect(()=>{var l;const n=(l=i.current)==null?void 0:l.getModel();n&&c&&R.setModelLanguage(n,c)},[c]),u.exports.useEffect(()=>{var n;(n=i.current)==null||n.updateOptions({readOnly:e.disbaled})},[e.disbaled]),u.exports.useEffect(()=>{var n,l;e.value!==((n=i.current)==null?void 0:n.getValue())&&((l=i.current)==null||l.setValue(e.value||""))},[e.value]),u.exports.useEffect(()=>{i.current=D();const n=i.current.onDidContentSizeChange(x),l=i.current.onDidChangeModelContent(()=>{var r;const o=i.current.getValue();e.disabledCacheDraft||p(E,o),o!==e.value&&((r=e.onChange)==null||r.call(e,o))});return()=>{var o,r;n.dispose(),l.dispose(),(r=(o=i.current)==null?void 0:o.dispose)==null||r.call(o)}},[]),a("div",{style:e.style,className:h(s.universalEditor,e.formStatus&&s.formStatus,d.state.fullscreen&&s.fullScreen),children:[!e.disabledToolbar&&a("div",{className:s.toolbar,children:[a(z,{className:s.left,children:[a(J.Text,{type:"secondary",strong:!0,className:s.logo,children:"UEditor"},void 0,!1,{fileName:t,lineNumber:233,columnNumber:13},void 0),a(_,{size:"small",disabled:e.disbaled,icon:a(K,{},void 0,!1,{fileName:t,lineNumber:239,columnNumber:21},void 0),onClick:S},void 0,!1,{fileName:t,lineNumber:236,columnNumber:13},void 0)]},void 0,!0,{fileName:t,lineNumber:232,columnNumber:11},void 0),a(z,{className:s.right,children:[(C=e.renderToolbarExtra)==null?void 0:C.call(e,c),c===m.Markdown&&a(_,{size:"small",disabled:e.disbaled,icon:f?a(G,{},void 0,!1,{fileName:t,lineNumber:249,columnNumber:35},void 0):a(q,{},void 0,!1,{fileName:t,lineNumber:249,columnNumber:67},void 0),onClick:()=>T(!f)},void 0,!1,{fileName:t,lineNumber:246,columnNumber:15},void 0),a(A,{size:"small",value:c,onChange:W,disabled:e.disbaled,className:s.language,options:[{label:"Markdown",value:m.Markdown},{label:"JSON",value:m.JSON}]},void 0,!1,{fileName:t,lineNumber:253,columnNumber:13},void 0),a(_,{size:"small",disabled:e.disbaled,icon:d.state.fullscreen?a(P,{},void 0,!1,{fileName:t,lineNumber:275,columnNumber:19},void 0):a(X,{},void 0,!1,{fileName:t,lineNumber:277,columnNumber:19},void 0),onClick:()=>d.setFullscreen(!d.state.fullscreen)},void 0,!1,{fileName:t,lineNumber:270,columnNumber:13},void 0)]},void 0,!0,{fileName:t,lineNumber:243,columnNumber:11},void 0)]},void 0,!0,{fileName:t,lineNumber:231,columnNumber:9},void 0),a(Y,{spinning:Boolean(e.loading),indicator:a(Q,{style:{fontSize:24},spin:!0},void 0,!1,{fileName:t,lineNumber:287,columnNumber:20},void 0),children:a("div",{className:s.container,children:[a("div",{id:"container",ref:g,className:h(s.editor,!e.value&&s.placeholder),placeholder:v},void 0,!1,{fileName:t,lineNumber:290,columnNumber:11},void 0),a(Z,{in:f,timeout:200,unmountOnExit:!0,classNames:"fade-fast",children:a("div",{className:h(s.preview),children:a("div",{className:s.markdown,dangerouslySetInnerHTML:{__html:ee(b)}},void 0,!1,{fileName:t,lineNumber:298,columnNumber:15},void 0)},void 0,!1,{fileName:t,lineNumber:297,columnNumber:13},void 0)},void 0,!1,{fileName:t,lineNumber:296,columnNumber:11},void 0)]},void 0,!0,{fileName:t,lineNumber:289,columnNumber:9},void 0)},void 0,!1,{fileName:t,lineNumber:285,columnNumber:7},void 0)]},void 0,!0,{fileName:t,lineNumber:222,columnNumber:5},void 0)};export{He as UEditorLanguage,ke as UniversalEditor,ze as getUEditorCache,Re as setUEditorCache};
