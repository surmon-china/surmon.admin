import{bt as E,ah as l,j as a,y,a5 as v,m as L,K as f,b4 as W,bu as O,af as T,an as z,bv as U,bw as D,z as F,a8 as H,bx as B,l as K}from"./vendor-cGau3IQd.js";import{U as w,a as $,m as I,s as P,t as R,b as Y,c as q}from"./index-7sTOAA-T.js";import{g as ge}from"./index-7sTOAA-T.js";import{W as A,a as G,m as J,K as Q,b as S}from"./monaco-editor-mYs-VUbL.js";import"./basic-rzFqXM0p.js";self.MonacoEnvironment={getWorker(e,m){return m==="json"?new A:new G}};E.config({monaco:J});E.init().then(()=>{console.log("monaco-editor is available.")});const V="_universalEditor_18ya2_5",X="_formStatus_18ya2_5",Z="_fullScreen_18ya2_13",p="_container_18ya2_25",ee="_toolbar_18ya2_28",ae="_logo_18ya2_39",ne="_language_18ya2_42",se="_editorWrapper_18ya2_51",te="_preview_18ya2_69",oe="_markdown_18ya2_79",s={universalEditor:V,formStatus:X,fullScreen:Z,container:p,toolbar:ee,logo:ae,language:ne,editorWrapper:se,preview:te,markdown:oe},ce=e=>{var _;const m=e.placeholder??"请输入内容...",c=e.value??"",h=e.eid||window.location.pathname,i=l.useRef(),[o,b]=l.useState(!1),[r,j]=l.useState(!1),[d,C]=l.useState(e.defaultLanguage||w.Markdown),g=l.useMemo(()=>({tabSize:2,fontSize:14,lineHeight:24,smoothScrolling:!0,readOnly:!!e.disbaled,minimap:{enabled:!e.disabledMinimap},folding:!0,contextmenu:!1,roundedSelection:!1,scrollBeyondLastLine:!1,wordBasedSuggestions:!0,acceptSuggestionOnEnter:"on",scrollbar:{alwaysConsumeMouseWheel:!1}}),[e.disbaled,e.disabledMinimap]),M=l.useMemo(()=>{const n=e.rows||34,t=g.lineHeight||24;return{height:o?"100%":`${n*t}px`}},[e.rows,g.lineHeight,o]),k=n=>{i.current=n,i.current.onDidFocusEditorText(()=>{var t,u;(t=i.current)==null||t.addCommand(Q.CtrlCmd|S.KeyS,x),(u=i.current)==null||u.addCommand(S.Escape,()=>b(!1))})},N=n=>{var t;e.disabledCacheDraft||P(h,n||""),(t=e.onChange)==null||t.call(e,n)},x=()=>{const n=R(Date.now()),t=Y.get(d).ext,u=`${h}-${n}.${t}`;q(c,u)};return l.useEffect(()=>{var n;o?((n=i.current)==null||n.focus(),document.body.classList.add("fullscreen")):document.body.classList.remove("fullscreen")},[o]),a.jsxs("div",{style:e.style,className:y(s.universalEditor,e.formStatus&&s.formStatus,o&&s.fullScreen),children:[!e.disabledToolbar&&a.jsxs("div",{className:s.toolbar,children:[a.jsxs(v,{className:s.left,wrap:!0,children:[a.jsx(L.Text,{type:"secondary",strong:!0,className:s.logo,children:"UEditor"}),a.jsx(f,{size:"small",disabled:e.disbaled,icon:a.jsx(W,{}),onClick:x})]}),a.jsxs(v,{className:s.right,wrap:!0,children:[(_=e.renderToolbarExtra)==null?void 0:_.call(e,d),d===w.Markdown&&a.jsx(f,{size:"small",disabled:e.disbaled,icon:r?a.jsx(O,{}):a.jsx(T,{}),onClick:()=>j(!r)}),a.jsx(z,{size:"small",className:s.language,value:d,onChange:C,disabled:e.disbaled||r,options:$.map(n=>({label:n.name,value:n.id}))}),a.jsx(f,{size:"small",disabled:e.disbaled,icon:o?a.jsx(U,{}):a.jsx(D,{}),onClick:()=>b(!o)})]})]}),a.jsx(F,{spinning:!!e.loading,indicator:a.jsx(H,{style:{fontSize:24},spin:!0}),children:a.jsxs("div",{className:s.container,children:[a.jsx(B,{wrapperProps:{"data-placeholder":m,"data-nonempty":!!c,className:s.editorWrapper,style:{width:r?"50%":"100%",...M}},className:s.editor,theme:"vs-dark",language:d,value:c,options:g,onChange:N,onMount:k}),a.jsx(K,{in:r,timeout:200,unmountOnExit:!0,classNames:"fade-fast",children:a.jsx("div",{className:y(s.preview),children:a.jsx("div",{className:s.markdown,dangerouslySetInnerHTML:{__html:I(c)}})})})]})})]})};export{w as UEditorLanguage,Y as UEditorLanguageMap,$ as UEditorLanguages,ce as UniversalEditor,ge as getUEditorCache,P as setUEditorCache};
