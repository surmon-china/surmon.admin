import{bw as j,ah as l,j as a,y as w,a5 as S,m as O,K as h,b6 as W,bx as L,af as T,aq as z,by as D,bz as F,z as H,a8 as B,bA as U,l as K}from"./vendor-0b927e4a.js";import{U as i,m as $,s as I,t as J,a as P}from"./index-6fe5c952.js";import{g as me}from"./index-6fe5c952.js";import{W as R,a as q,m as A,K as Y,b as v}from"./monaco-editor-9a3f3f20.js";import"./basic-620e319b.js";self.MonacoEnvironment={getWorker(e,g){return g==="json"?new R:new q}};j.config({monaco:A});j.init().then(()=>{console.log("monaco-editor is available.")});const G="_universalEditor_18ya2_5",Q="_formStatus_18ya2_5",V="_fullScreen_18ya2_13",X="_container_18ya2_25",Z="_toolbar_18ya2_28",p="_logo_18ya2_39",ee="_language_18ya2_42",ae="_editorWrapper_18ya2_51",ne="_preview_18ya2_69",se="_markdown_18ya2_79",n={universalEditor:G,formStatus:Q,fullScreen:V,container:X,toolbar:Z,logo:p,language:ee,editorWrapper:ae,preview:ne,markdown:se},te=new Map([[i.Markdown,"md"],[i.JSON,"json"]]),de=e=>{var _;const g=e.placeholder??"请输入内容...",u=e.value??"",b=e.eid||window.location.pathname,r=l.useRef(),[o,x]=l.useState(!1),[d,E]=l.useState(!1),[c,C]=l.useState(e.defaultLanguage||i.Markdown),f=l.useMemo(()=>({tabSize:2,fontSize:14,lineHeight:24,smoothScrolling:!0,readOnly:!!e.disbaled,minimap:{enabled:!e.disabledMinimap},folding:!0,contextmenu:!1,roundedSelection:!1,scrollBeyondLastLine:!1,wordBasedSuggestions:!0,acceptSuggestionOnEnter:"on",scrollbar:{alwaysConsumeMouseWheel:!1}}),[e.disbaled,e.disabledMinimap]),M=l.useMemo(()=>{const s=e.rows||34,t=f.lineHeight||24;return{height:o?"100%":`${s*t}px`}},[e.rows,f.lineHeight,o]),k=s=>{r.current=s,r.current.onDidFocusEditorText(()=>{var t,m;(t=r.current)==null||t.addCommand(Y.CtrlCmd|v.KeyS,y),(m=r.current)==null||m.addCommand(v.Escape,()=>x(!1))})},N=s=>{var t;e.disabledCacheDraft||I(b,s||""),(t=e.onChange)==null||t.call(e,s)},y=()=>{const s=J(Date.now()),t=te.get(c),m=`${b}-${s}.${t}`;P(u,m)};return l.useEffect(()=>{var s;o?((s=r.current)==null||s.focus(),document.body.classList.add("fullscreen")):document.body.classList.remove("fullscreen")},[o]),a.jsxs("div",{style:e.style,className:w(n.universalEditor,e.formStatus&&n.formStatus,o&&n.fullScreen),children:[!e.disabledToolbar&&a.jsxs("div",{className:n.toolbar,children:[a.jsxs(S,{className:n.left,wrap:!0,children:[a.jsx(O.Text,{type:"secondary",strong:!0,className:n.logo,children:"UEditor"}),a.jsx(h,{size:"small",disabled:e.disbaled,icon:a.jsx(W,{}),onClick:y})]}),a.jsxs(S,{className:n.right,wrap:!0,children:[(_=e.renderToolbarExtra)==null?void 0:_.call(e,c),c===i.Markdown&&a.jsx(h,{size:"small",disabled:e.disbaled,icon:d?a.jsx(L,{}):a.jsx(T,{}),onClick:()=>E(!d)}),a.jsx(z,{size:"small",value:c,onChange:C,disabled:e.disbaled||d,className:n.language,options:[{label:"Markdown",value:i.Markdown},{label:"JSON",value:i.JSON}]}),a.jsx(h,{size:"small",disabled:e.disbaled,icon:o?a.jsx(D,{}):a.jsx(F,{}),onClick:()=>x(!o)})]})]}),a.jsx(H,{spinning:!!e.loading,indicator:a.jsx(B,{style:{fontSize:24},spin:!0}),children:a.jsxs("div",{className:n.container,children:[a.jsx(U,{wrapperProps:{"data-placeholder":g,"data-nonempty":!!u,className:n.editorWrapper,style:{width:d?"50%":"100%",...M}},className:n.editor,theme:"vs-dark",language:c,value:u,options:f,onChange:N,onMount:k}),a.jsx(K,{in:d,timeout:200,unmountOnExit:!0,classNames:"fade-fast",children:a.jsx("div",{className:w(n.preview),children:a.jsx("div",{className:n.markdown,dangerouslySetInnerHTML:{__html:$(u)}})})})]})})]})};export{i as UEditorLanguage,de as UniversalEditor,me as getUEditorCache,I as setUEditorCache};
